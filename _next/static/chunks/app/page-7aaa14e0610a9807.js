(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[931],{1456:function(e,i,a){Promise.resolve().then(a.bind(a,333))},333:function(e,i,a){"use strict";a.r(i),a.d(i,{default:function(){return b}});var t=a(7437),s=a(2265),n=a(8472);a(9252);var r=a(4446),c=a(4041);function l(e){let{post:i,add:a,remove:s,check:n,toggleFavorites:r}=e,{main:l,name:o,weather:d,wind:m,sys:u}=i;return(0,t.jsxs)(c.E.div,{className:"weather-card",initial:{opacity:0,y:-50},animate:{opacity:1,y:0},transition:{type:"spring",bounce:.5,duration:.7,delayChildren:.5,staggerChildren:.5},children:[(0,t.jsxs)("h2",{children:[o," ",(0,t.jsx)("sup",{children:u.country})]}),(0,t.jsxs)("h1",{children:[Math.round(l.temp),(0,t.jsx)("sup",{children:"\xb0C"})]}),(0,t.jsx)("img",{src:"/img/".concat(d[0].icon,".svg"),alt:"",className:"weather-img"}),(0,t.jsxs)("div",{className:"weather-details",children:[(0,t.jsxs)("div",{className:"humidity",children:[(0,t.jsx)("i",{className:"bi bi-water"}),(0,t.jsxs)("div",{className:"text",children:[(0,t.jsx)("span",{children:l.humidity}),(0,t.jsx)("p",{children:"Humidade"})]})]}),(0,t.jsxs)("div",{className:"wind",children:[(0,t.jsx)("i",{className:"bi bi-wind"}),(0,t.jsxs)("div",{className:"text",children:[(0,t.jsx)("span",{children:m.speed}),(0,t.jsx)("p",{children:"Velocidade"})]})]}),(0,t.jsx)("button",{className:"btn-favorite",children:(0,t.jsx)("i",{className:n(o)?"bi bi-star-fill":"bi bi-star",onClick:r})})]})]})}var o=e=>{let{message:i,duration:a,onClose:n}=e;return(0,s.useEffect)(()=>{if(i){let e=setTimeout(()=>{n()},a||3e3);return()=>clearTimeout(e)}},[i,a,n]),(0,t.jsx)(r.M,{children:i&&(0,t.jsx)(c.E.div,{className:"notification-box",initial:{opacity:0,x:50},animate:{opacity:1,x:0},exit:{opacity:0,x:50},transition:{duration:.5},children:(0,t.jsx)("p",{children:i})})})},d=e=>{let{favorites:i,removeFromFavorites:a,displayFavoriteCity:n,isVisible:r,toggleVisibility:l}=e;return((0,s.useEffect)(()=>{},[i]),r)?(0,t.jsxs)(c.E.div,{className:"favorites-box",initial:{opacity:0},animate:{opacity:1},transition:{type:"spring",bounce:.5,duration:.7},children:[(0,t.jsx)("button",{className:"btn-hide",onClick:l,children:(0,t.jsx)("i",{className:"bi bi-x-circle"})}),(0,t.jsx)("h2",{children:"Favoritos"}),(0,t.jsx)("div",{className:"favorites-list",children:(0,t.jsx)("ul",{children:i.map(e=>(0,t.jsxs)("li",{"data-city":e,children:[(0,t.jsx)("span",{onClick:()=>n(e),children:e}),(0,t.jsx)("i",{className:"bi bi-star-fill",onClick:()=>a(e)})]},e))})})]}):null},m=e=>{let{showModal:i,setShowModal:a,handleMail:n}=e,[r,l]=(0,s.useState)("");return i?(0,t.jsx)(c.E.div,{className:"modal-mail",initial:{opacity:0},animate:{opacity:1},transition:{type:"spring",bounce:.5,duration:.7,delayChildren:.5,staggerChildren:.5},children:(0,t.jsxs)("div",{className:"modal-content",children:[(0,t.jsx)("h1",{children:"Digite seu e-mail"}),(0,t.jsx)("form",{onSubmit:e=>{e.preventDefault(),n(r)},children:(0,t.jsxs)("div",{className:"input-box",children:[(0,t.jsx)("input",{type:"email",value:r,onChange:e=>l(e.target.value),required:!0}),(0,t.jsx)("button",{type:"submit",className:"btn-submit",children:(0,t.jsx)("i",{className:"bi bi-box-arrow-in-right"})})]})}),(0,t.jsx)("button",{onClick:()=>a(!1),className:"btn-hide",children:(0,t.jsx)("i",{className:"bi bi-x-circle"})})]})}):null};let u=(0,a(4593).eI)("https://ssdvbegizsfanbzbmjbu.supabase.co","eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InNzZHZiZWdpenNmYW5iemJtamJ1Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3Mjc1NzYyMDUsImV4cCI6MjA0MzE1MjIwNX0.jglYIKpGvEG539jrix4ZRQMlbptzx_SxcGGQS7nbEvc");var x=a(357);let h=n.Z.create({baseURL:"https://api.openweathermap.org/data/2.5/"});function b(){let[e,i]=s.useState([]),[a,n]=s.useState(""),[b,j]=s.useState(""),[p,f]=s.useState(!1),[v,y]=s.useState(!1),[N,g]=s.useState(!1),[E,C]=s.useState([]),[w,I]=s.useState(""),[_,S]=s.useState(!1),M=x.env.NEXT_PUBLIC_WEATHER_API_KEY;s.useEffect(()=>{async function e(){try{let e="weather?q=".concat(b,"&appid=").concat(M,"&units=metric&lang=pt_br"),a=await h.get(e);404===a.data.cod?(k("Cidade n\xe3o encontrada"),f(!1)):(i(e=>[...e,a.data]),F(),f(!0))}catch(e){console.log("Erro ao fazer a requisi\xe7\xe3o:",e),k("Cidade n\xe3o encontrada"),f(!1)}}b&&e()},[b]);let k=e=>{y(e)},F=()=>{y("")},z=e=>!!/^[a-zA-Z\u00C0-\u00FF\s]+$/.test(e),J=async()=>{if(!w){S(!0);return}let{data:e,error:i}=await u.from("citiesFav").select("city_name").eq("email",w);if(i){console.log("Erro ao buscar favoritos:",i),k("Erro ao buscar favoritos.");return}C(e)},Z=async e=>{if(!w){S(!0);return}let{data:i,error:a}=await u.from("user").select("email").eq("email",w);if(0===i.length){let{data:e,error:i}=await u.from("user").insert([{email:w}])}let{data:t,error:s}=await u.from("citiesFav").insert([{email:w,city_name:e.name}]);if(s){console.log("Erro ao adicionar favorito:",s),k("Erro ao adicionar favorito.");return}J()},q=async e=>{let{data:i,error:a}=await u.from("citiesFav").delete().eq("email",w).eq("city_name",e);if(a){console.log("Erro ao remover favorito:",a),k("Erro ao remover favorito.");return}J()},D=e=>E.some(i=>i.city_name===e),Y=()=>{if(!w){S(!0);return}g(!N),J()},G=i=>{if(E.some(e=>e.city_name===i))q(i);else{let a=e.find(e=>e.name===i);a&&Z(a)}};return(0,t.jsxs)("section",{className:"container",children:[(0,t.jsx)("button",{className:"btn-favorites","data-city":"${city.name}",onClick:()=>Y(!N),children:(0,t.jsx)("i",{className:"bi bi-star-fill"})}),(0,t.jsx)(m,{showModal:_,setShowModal:S,handleMail:e=>{I(e),S(!1),J()}}),(0,t.jsx)(d,{favorites:E.map(e=>e.city_name),removeFromFavorites:q,displayFavoriteCity:j,isVisible:N,toggleVisibility:()=>Y(!N)}),(0,t.jsxs)("div",{className:"city-box",children:[(0,t.jsx)("h1",{children:"Digite o nome de uma cidade:"}),(0,t.jsxs)("div",{className:"input-box",children:[(0,t.jsx)("i",{className:"bi bi-geo-alt-fill btn-geo"}),(0,t.jsxs)("form",{onSubmit:e=>{if(e.preventDefault(),!z(a)){k("Nome da cidade inv\xe1lida");return}if(""===a){k("Digite alguma cidade.");return}j(a),n("")},children:[(0,t.jsx)("input",{type:"text",className:"input-cidade",value:a,onChange:e=>n(e.target.value)}),(0,t.jsx)("button",{type:"submit",className:"btn-submit",children:(0,t.jsx)("i",{className:"bi bi-search"})})]}),(0,t.jsx)("p",{className:"submit-warning"})]})]}),(0,t.jsx)("div",{className:"weather-box",children:(0,t.jsx)(r.M,{children:e.map((e,i)=>(0,t.jsx)(c.E.div,{initial:{opacity:0,x:100,scale:.9},animate:{opacity:1,x:0,scale:1},exit:{opacity:0,x:-100},transition:{duration:.5},children:(0,t.jsx)(l,{post:e,add:Z,remove:q,check:D,toggleFavorites:()=>G(e.name)})},i))})}),(0,t.jsx)(o,{message:v,duration:3e3,onClose:F})]})}}},function(e){e.O(0,[51,719,971,23,744],function(){return e(e.s=1456)}),_N_E=e.O()}]);